<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../js-zip/js-zip.html">
<!--
  `<zip-download></zip-download>` button to download multiple text files 
  @demo demo.html
-->
<dom-module id="zip-download">
  <template>
    <template is="dom-if" if="{{files}}">
      <button on-tap="zip">{{text}}</button>
    </template>
  </template>
</dom-module>
<script>
  Polymer({
    is: "zip-download",
    properties:{
      text:{
        type:String,
        value:"download",
      },
      name: {
        type:String,
        value:"file",
      },
      files:Object,
    },
    zip: function(){
      if (this.files) {
	var zip = new JSZip()
	var that = this
        function catOutFiles(value) {
          zip.file(value, that.files[value])
        }
        Object.keys(this.files).forEach(catOutFiles)
        zip.generateAsync({type:"blob"})
        .then(function(content) {
          saveAs(content, that.name + ".zip")
        })
      }
    },
  })
</script>
